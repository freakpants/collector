<!doctype html>
<html>

<head>
  <title>Summer Swaps 2 Token Tracker</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <link rel="stylesheet" href="css.css">
</head>

<body>
  <div class="header">
    <h1>Summer Swaps 2</h1>
    <h2>Token Tracker</h2>
    <div id="attribution">
      <h3>Inspired by <span id="criminal" class="link">@Criminal__x</span></h3>
      <h3>Data and Assets by <span id="wefut" class="link">WeFUT</span></h3>
      <h3>Implementation by <span id="freakpants" class="link">@freakpants</span></h3>

    </div>
    <div id="button-wrapper">
      <button id="unclaim" class="btn-standard call-to-action">
        <span class="button__text">Unclaim tokens</span>
      </button>
      <button id="reset" class="btn-standard call-to-action">
        <span class="button__text">Reset all claimed tokens</span>
      </button>
      <button id="rewards" class="btn-standard call-to-action">
        <span class="button__text">Rewards</span>
      </button>
      <div>
        <div>
          <input type="checkbox" id="sbc" name="sbc" checked>
          <label for="sbc">SBC's</label>
        </div>
        <div>
          <input type="checkbox" id="objectives" name="objectives" checked>
          <label for="objectives">Objectives</label>
        </div>
        <div>
          <input type="checkbox" id="packs" name="packs" checked>
          <label for="packs">Packs</label>
        </div>
      </div>
    </div>


  </div>
  <div id="tokens"></div>
</body>
<script>

  document.unclaim_mode = false;

  const playerIdentity = window.location.search.substr(1);

  let tokens_number = 0;
  const players = ["<div class=\"card bronze fifa22\" data-base-id=\"166847\" data-club-id=\"306\" data-nation-id=\"25\" data-league-id=\"65\" data-rareflag=\"0\">\r\n    <div class=\"token_number\">1<\/div><div class=\"scard bronze fifa22\" style=\"position: relative; z-index: 2\">\r\n            <img src=\"token.png\" alt=\"\" class=\"player-card\">\r\n\r\n            <div class=\"rating-gradient\"><\/div>\r\n\r\n                        <a href=\"https:\/\/wefut.com\/club\/306\">\r\n                            <img src=\"https:\/\/static.wefut.com\/assets\/images\/fut22\/clubbadges\/306.png?21\" alt=\"\" class=\"clubbadge\">\r\n                        <\/a>\r\n            \r\n            <div class=\"avatarholder \">\r\n                <img src=\"https:\/\/static.wefut.com\/assets\/images\/fut22\/playeravatars\/166847.png?21\" onerror=\"this.src='https:\/\/static.wefut.com\/assets\/images\/fut15\/playeravatars\/unknown.png'\" alt=\"\" class=\"avatar\">\r\n            <\/div>\r\n\r\n                        <a href=\"https:\/\/wefut.com\/nation\/25\">\r\n                            <img src=\"https:\/\/static.wefut.com\/assets\/images\/nation_flag\/25.jpg\" class=\"nationflag\">\r\n                        <\/a>\r\n            \r\n            <div class=\"ratingholder\"><span class=\"rating\"  style=\"border: 0px !important\" >60<\/span><\/div>\r\n            <span class=\"position\">CM<\/span>\r\n            <div class=\"nonrare name\">\r\n            <span class=\"marquee\" data-base-id=166847>McCann<\/span>\r\n        <\/div>\r\n        <div class=\"token_source\">Free Token<\/div><div data-timestamp='0' class=\"token_objective_wrapper\">\r\n            \n                           \r\n\r\n            \r\n            \n            \n            \n            \n            \n            \n        <\/div>\r\n    <\/div>\r\n    <\/div>\r\n<\/div><div style=\"display:none\"><input type=\"hidden\" data-type=\"name\" data-base-id=166847 value=\"Chris McCann\"<\/input><\/div>","<div class=\"card bronze fifa22\" data-base-id=\"52679\" data-club-id=\"15048\" data-nation-id=\"25\" data-league-id=\"61\" data-rareflag=\"0\">\r\n    <div class=\"token_number\">2<\/div><div class=\"scard bronze fifa22\" style=\"position: relative; z-index: 2\">\r\n            <img src=\"token.png\" alt=\"\" class=\"player-card\">\r\n\r\n            <div class=\"rating-gradient\"><\/div>\r\n\r\n                        <a href=\"https:\/\/wefut.com\/club\/15048\">\r\n                            <img src=\"https:\/\/static.wefut.com\/assets\/images\/fut22\/clubbadges\/15048.png?21\" alt=\"\" class=\"clubbadge\">\r\n                        <\/a>\r\n            \r\n            <div class=\"avatarholder \">\r\n                <img src=\"https:\/\/static.wefut.com\/assets\/images\/fut22\/playeravatars\/52679.png?21\" onerror=\"this.src='https:\/\/static.wefut.com\/assets\/images\/fut15\/playeravatars\/unknown.png'\" alt=\"\" class=\"avatar\">\r\n            <\/div>\r\n\r\n                        <a href=\"https:\/\/wefut.com\/nation\/25\">\r\n                            <img src=\"https:\/\/static.wefut.com\/assets\/images\/nation_flag\/25.jpg\" class=\"nationflag\">\r\n                        <\/a>\r\n            \r\n            <div class=\"ratingholder\"><span class=\"rating\"  style=\"border: 0px !important\" >60<\/span><\/div>\r\n            <span class=\"position\">GK<\/span>\r\n            <div class=\"nonrare name\">\r\n            <span class=\"marquee\" data-base-id=52679>Murphy<\/span>\r\n        <\/div>\r\n        <div class=\"token_source\">Cornet Objective<\/div><div data-timestamp='1659805200' class=\"token_objective_wrapper\"><div data-type=\"objective\" class=\"token_objective\">EXP <b>Aug 06<\/b><\/div><\/div>\r\n            \n                           \r\n\r\n            \r\n            \n            \n            \n            \n            \n            \n        <\/div>\r\n    <\/div>\r\n    <\/div>\r\n<\/div><div style=\"display:none\"><input type=\"hidden\" data-type=\"name\" data-base-id=52679 value=\"Joe Murphy\"<\/input><\/div>","<div class=\"card bronze fifa22\" data-base-id=\"111328\" data-club-id=\"1929\" data-nation-id=\"14\" data-league-id=\"60\" data-rareflag=\"0\">\n    <div class=\"token_number\">3<\/div><div class=\"scard bronze fifa22\" style=\"position: relative; z-index: 2\">\n            <img src=\"token.png\" alt=\"\" class=\"player-card\">\n\n            <div class=\"rating-gradient\"><\/div>\n\n                        <a href=\"https:\/\/wefut.com\/club\/1929\">\n                            <img src=\"https:\/\/static.wefut.com\/assets\/images\/fut22\/clubbadges\/1929.png?21\" alt=\"\" class=\"clubbadge\">\n                        <\/a>\n            \n            <div class=\"avatarholder \">\n                <img src=\"https:\/\/static.wefut.com\/assets\/images\/fut22\/playeravatars\/111328.png?21\" onerror=\"this.src='https:\/\/static.wefut.com\/assets\/images\/fut15\/playeravatars\/unknown.png'\" alt=\"\" class=\"avatar\">\n            <\/div>\n\n                        <a href=\"https:\/\/wefut.com\/nation\/14\">\n                            <img src=\"https:\/\/static.wefut.com\/assets\/images\/nation_flag\/14.jpg\" class=\"nationflag\">\n                        <\/a>\n            \n            <div class=\"ratingholder\"><span class=\"rating\"  style=\"border: 0px !important\" >60<\/span><\/div>\n            <span class=\"position\">GK<\/span>\n            <div class=\"nonrare name\">\n            <span class=\"marquee\" data-base-id=111328>McCormick<\/span>\n        <\/div>\n        <div class=\"token_source\">FUT 14 SBC<\/div><div data-timestamp='1659459600' class=\"token_objective_wrapper\"><div data-type=\"sbc\" class=\"token_objective\">EXP <b>Aug 02<\/b><\/div><\/div>\n            \n                           \n\n            \n            \n            \n            \n            \n            \n            \n        <\/div>\n    <\/div>\n    <\/div>\n<\/div><div style=\"display:none\"><input type=\"hidden\" data-type=\"name\" data-base-id=111328 value=\"Luke McCormick\"<\/input><\/div>","<div class=\"card bronze fifa22\" data-base-id=\"240955\" data-club-id=\"101084\" data-nation-id=\"52\" data-league-id=\"353\" data-rareflag=\"0\">\r\n    <div class=\"token_number\">4<\/div><div class=\"scard bronze fifa22\" style=\"position: relative; z-index: 2\">\r\n            <img src=\"token.png\" alt=\"\" class=\"player-card\">\r\n\r\n            <div class=\"rating-gradient\"><\/div>\r\n\r\n                        <a href=\"https:\/\/wefut.com\/club\/101084\">\r\n                            <img src=\"https:\/\/static.wefut.com\/assets\/images\/fut22\/clubbadges\/101084.png?21\" alt=\"\" class=\"clubbadge\">\r\n                        <\/a>\r\n            \r\n            <div class=\"avatarholder \">\r\n                <img src=\"https:\/\/static.wefut.com\/assets\/images\/fut22\/playeravatars\/240955.png?21\" onerror=\"this.src='https:\/\/static.wefut.com\/assets\/images\/fut15\/playeravatars\/unknown.png'\" alt=\"\" class=\"avatar\">\r\n            <\/div>\r\n\r\n                        <a href=\"https:\/\/wefut.com\/nation\/52\">\r\n                            <img src=\"https:\/\/static.wefut.com\/assets\/images\/nation_flag\/52.jpg\" class=\"nationflag\">\r\n                        <\/a>\r\n            \r\n            <div class=\"ratingholder\"><span class=\"rating\"  style=\"border: 0px !important\" >60<\/span><\/div>\r\n            <span class=\"position\">GK<\/span>\r\n            <div class=\"nonrare name\">\r\n            <span class=\"marquee\" data-base-id=240955>Durso<\/span>\r\n        <\/div>\r\n        <div class=\"token_source\">Against the Tide SBC<\/div><div data-timestamp='1659546000' class=\"token_objective_wrapper\"><div data-type=\"sbc\" class=\"token_objective\">EXP <b>Aug 03<\/b><\/div><\/div>\r\n            \n                           \r\n\r\n            \r\n            \n            \n            \n            \n            \n            \n        <\/div>\r\n    <\/div>\r\n    <\/div>\r\n<\/div><div style=\"display:none\"><input type=\"hidden\" data-type=\"name\" data-base-id=240955 value=\"Tom\u00e1s Durso\"<\/input><\/div>"];
  players.forEach(function (player) {
    $('#tokens').append(player);
    tokens_number++;
  });

  // generate the rest of the empty divs
  for (let i = tokens_number; i < 50; i++) {
    $('#tokens').append(`
      <div class="card bronze fifa22 inactive" data-base-id="" data-club-id="1929" data-nation-id="14" data-league-id="60" data-rareflag="0">
          <div class="token_number">${i + 1}</div>
          <div class="scard bronze fifa22 style="position: relative; z-index: 2">

              <img src="token.png" alt="" class="player-card">
  
              <div class="rating-gradient"></div>

              
              <div class="avatarholder ">
                  </div>
  
        
              

          </div>
      </div>
      </div>
      `);
  }

  let claimed_tokens = '';
  if (playerIdentity !== '') {
    claimed_tokens = localStorage.getItem('claimed_tokens' + playerIdentity);
  } else {
    claimed_tokens = localStorage.getItem('claimed_tokens');
  }

  if (claimed_tokens == null) {
    claimed_tokens = [];
    claimed_tokens.push(166847);
  } else {
    claimed_tokens = JSON.parse(claimed_tokens);
  }
  claimed_tokens.forEach(function (token) {
    $('div[data-base-id="' + token + '"]').addClass('token-claimed');
  });

  // add data counter to each card
  // $('#tokens > div').each(function(index) {
  //   $(this).attr('data-token-id', index + 1);
  // });

  $('#tokens div').each(function (index) {
    // if this has class token_source, dont darken
    if (!$(this).hasClass('token_source') && !$(this).hasClass('token_objective') && !$(this).hasClass('token_objective_wrapper')) {
      $(this).addClass('darken');
    }
  });

  $('#tokens .card.fifa22').click(function () {
    if ($(this).hasClass('inactive')) {
      return;
    }
    if ($(this).hasClass('token-claimed')) {
      if (document.unclaim_mode == true) {
        console.log("removing token-claimed class");
        $(this).removeClass("token-claimed");
        let token_id = $(this).data('base-id');
        let index = claimed_tokens.indexOf(token_id);
        claimed_tokens.splice(index, 1);
        if (playerIdentity !== '') {
          localStorage.setItem("claimed_tokens" + playerIdentity, JSON.stringify(claimed_tokens));
        } else {
          localStorage.setItem("claimed_tokens", JSON.stringify(claimed_tokens));
        }

        return;
      } else {
        console.log("doing nothing because unclaim mode is false");
        return;
      }
    }
    $(this).addClass('token-claimed');
    claimed_tokens.push($(this).data('base-id'));
    if (playerIdentity !== '') {
      localStorage.setItem("claimed_tokens" + playerIdentity, JSON.stringify(claimed_tokens));
    } else {
      localStorage.setItem("claimed_tokens", JSON.stringify(claimed_tokens));
    }
  });

  $("#reset").click(function () {
    if (playerIdentity !== '') {
      localStorage.setItem("claimed_tokens" + playerIdentity, JSON.stringify([]));
    } else {
      localStorage.setItem("claimed_tokens", JSON.stringify([]));
    }
    location.reload();
  }
  );

  $("#unclaim").click(function () {
    if (document.unclaim_mode == true) {
      document.unclaim_mode = false;
      $("#unclaim").removeClass("mode-active");
    } else {
      document.unclaim_mode = true;
      $("#unclaim").addClass("mode-active");
    }
  }
  );

  $("#rewards").click(function () {
    location.href = "https://pbs.twimg.com/media/FYrZ_Q5WYAAKwr0?format=jpg&name=900x900";
  }
  );

  $("#criminal").click(function () {
    location.href = "https://twitter.com/Criminal__x";
  }
  );

  $("#wefut").click(function () {
    location.href = "https://wefut.com/player-database";
  }
  );

  $("#freakpants").click(function () {
    location.href = "https://twitter.com/freakpants";
  }
  );

  $(".marquee").click(function (event) {

    const id = $(event.target).data("base-id");
    var copyTextarea = document.querySelector('[data-type="name"][data-base-id="' + id + '"]');
    console.log(copyTextarea);

    $(copyTextarea).parent().show();

    copyTextarea.type = "text";
    copyTextarea.focus();
    copyTextarea.select();
    document.execCommand("copy");
    $(copyTextarea).parent().hide();
    copyTextarea.type = "hidden";
    event.stopPropagation();
  });

  $("#objectives").click(function () {
    if (this.checked) {
      $("[data-type='objective']").closest(".fifa22.card").fadeIn();
    } else {
      $("[data-type='objective']").closest(".fifa22.card").fadeOut();
    }
  });

  $("#sbc").click(function () {
    if (this.checked) {
      $("[data-type='sbc']").closest(".fifa22.card").fadeIn();
    } else {
      $("[data-type='sbc']").closest(".fifa22.card").fadeOut();
    }
  });

  $("#packs").click(function () {
    if (this.checked) {
      $("[data-type='pack']").closest(".fifa22.card").fadeIn();
    } else {
      $("[data-type='pack']").closest(".fifa22.card").fadeOut();
    }
  });

  $(".token_objective_wrapper").each(function (index) {
    const timeStamp = $(this).attr('data-timestamp');
    if(timeStamp == 0){
      return;
    }
    const timeLeft = timeStamp - (Math.floor(Date.now()/1000));
    const timeLeftDays = Math.floor(timeLeft/86400);
    if(timeLeftDays <= 2){
      const timeLeftHours = Math.floor(timeLeft / 3600);
      $(this).find(".token_objective").append('<b> (' + timeLeftHours + 'H)</b>');
    }
  }
  );





</script>

</html>